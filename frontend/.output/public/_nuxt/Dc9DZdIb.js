import{_ as N}from"./Bsrf37Yq.js";import{_ as U,r as v,v as V,c as a,b as m,a as e,w,t as i,B as C,F as b,e as y,I as D,E as k,J as E,n as x,d as g,z as B,U as I,M as P,o,L as R}from"./BeuPNDKa.js";import{_ as G}from"./DBEUCIjR.js";import{_ as J}from"./DF3qM6BK.js";import{u as F}from"./C3kHl5Uz.js";import"./DJCvy_yv.js";const O={class:"w-full rounded-3xl flex flex-col gap-7 overflow-hidden"},q={class:"border-l-2 border-teal-300"},H={class:"p-2"},W={class:"flex flex-col gap-4 w-full overflow-y-auto max-h-[600px] sm:max-h-[700px]"},K=["src"],Q={class:"grid gap-0"},X={class:"text-white text-sm sm:text-base font-medium font-['Shabnam']"},Y={key:0,class:"mt-2 flex flex-col gap-2"},Z=["href"],ee={class:"flex flex-col gap-4"},te={class:"relative w-full"},se={key:0,class:"text-red-500 text-sm mt-1"},ae={key:1,class:"mt-2 flex flex-wrap gap-2"},oe={class:"text-white text-sm"},re={class:"flex flex-col sm:flex-row gap-4 justify-end"},le={class:"relative w-44 h-12"},ne={class:"absolute inset-0 flex items-center justify-center bg-transparent rounded-3xl border border-primary shadow-[0_0_6px_rgba(202,23,92,1)] text-white text-base font-medium font-['Shabnam'] cursor-pointer hover:bg-primary/10 transition-colors"},ie={__name:"[id]",async setup(de){let _,M;const{addToast:z}=R();v();const{data:S,status:ce}=([_,M]=V(()=>F(`tickets/${B().params.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})),_=await _,M(),_),d=v(""),n=v([]),r=v({}),A=P(),L=c=>{const s=Array.from(c.target.files),u=["image/jpeg","image/png","application/pdf"],h=5*1024*1024;s.forEach(l=>{if(!u.includes(l.type)){r.value.files="Only JPEG, PNG, and PDF files are allowed.";return}if(l.size>h){r.value.files="File size must be less than 5MB.";return}const p=new FileReader;p.onload=t=>{n.value.push({name:l.name,url:t.target.result}),r.value.files=""},p.readAsDataURL(l)})},$=c=>{n.value.splice(c,1)},T=async()=>{if(r.value={},!d.value.trim()){r.value.message="Message is required.";return}const{data:c,status:s,error:u}=await F(`tickets/${B().params.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},method:"POST",body:{message:d.value,files:n.value}});s.value=="success"?(d.value="",n.value=[],A.push("/dashboard/support"),z("Ticket replies successfully!","success",5e3)):console.log(u.value)};return(c,s)=>{var l,p;const u=I("router-link"),h=N;return o(),a("div",O,[m(u,{to:"/dashboard/support",class:"relative w-52 h-12 flex items-center justify-center bg-transparent rounded-3xl border border-primary shadow-[0_0_6px_rgba(202,23,92,1)] text-white text-base font-medium font-['Shabnam'] hover:bg-primary/10 transition-colors"},{default:w(()=>s[1]||(s[1]=[e("span",{class:"flex items-center gap-2"},[e("svg",{class:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M9 15L3 9L9 3","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M3 9H21","stroke-linecap":"round","stroke-linejoin":"round"})]),g(" Back to Messages ")],-1)])),_:1}),e("div",q,[e("span",H,i((l=C(S))==null?void 0:l.description),1)]),e("div",W,[(o(!0),a(b,null,y((p=C(S))==null?void 0:p.replies,t=>(o(),a("div",{key:t.id,class:x(["flex",t.isSent?"justify-end":"justify-start"])},[e("div",{class:x(["flex items-end gap-2 max-w-[90%] sm:max-w-[80%]",t.isSent?"flex-row-reverse":"flex-row"])},[e("img",{src:t.avatar||"https://placehold.co/40x40",alt:"User Avatar",class:"w-10 h-10 rounded-full"},null,8,K),e("div",Q,[e("div",{class:x(["p-2.5 rounded-tl-[10px] rounded-br-[10px]",t.isSent?"bg-primary rounded-tr-[10px]":"bg-[#514078] rounded-bl-[10px]"])},[e("p",X,i(t.message),1),t.files?(o(),a("div",Y,[(o(!0),a(b,null,y(t.files,(f,j)=>(o(),a("a",{key:j,href:f.url,target:"_blank",class:"text-blue-300 text-sm hover:underline"},i(f.name),9,Z))),128))])):k("",!0)],2),e("div",{class:x(["flex items-center gap-1 text-gray-400 text-xs sm:text-sm font-medium font-['Shabnam'] text-nowrap",t.isSent?"justify-start":"justify-end"])},[m(h,{name:"iconsax/bulk/calendar"}),g(" "+i(t==null?void 0:t.human_date),1)],2)])],2)],2))),128))]),e("div",ee,[e("div",te,[D(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t),placeholder:"Write your message ...",class:x(["w-full h-32 p-4 bg-[#14082A] border border-[#514078] rounded-2xl text-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-primary resize-none",{"border-red-500":r.value.message}])},null,2),[[E,d.value]]),r.value.message?(o(),a("p",se,i(r.value.message),1)):k("",!0),n.value.length?(o(),a("div",ae,[(o(!0),a(b,null,y(n.value,(t,f)=>(o(),a("div",{key:f,class:"flex items-center gap-2 bg-gray-800 p-2 rounded-lg"},[e("span",oe,i(t.name),1),m(J,{onClick:j=>$(f)},{default:w(()=>s[2]||(s[2]=[e("svg",{class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M6 18L18 6M6 6l12 12"})],-1)])),_:2},1032,["onClick"])]))),128))])):k("",!0)]),e("div",re,[e("label",le,[e("input",{type:"file",multiple:"",class:"hidden",onChange:L},null,32),e("span",ne,[m(h,{name:"iconsax/linear/paperclip-2"}),s[3]||(s[3]=g(" Attachment "))])]),m(G,{onClick:T,class:"justify-center"},{default:w(()=>s[4]||(s[4]=[e("span",{class:"flex items-center gap-2"},[g(" Send Message "),e("svg",{class:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M5 13L9 17L19 7","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)])),_:1})])])])}}},he=U(ie,[["__scopeId","data-v-a0d43e4f"]]);export{he as default};
